---

---

<nav
  data-state="close"
  id="mobile-menu"
  class="fixed bg-primary dark:bg-secondary top-0 h-screen right-0 left-0 z-40 overflow-hidden opacity-0 pointer-events-none transition-opacity duration-300"
>
  <div class="container flex flex-col justify-between h-full pb-16">
    <div class="pt-24 pb-8 flex flex-col justify-between h-full"></div>
    <div class="border-t-2 border-white mt-auto py-4 text-white opacity-80"></div>
  </div>
</nav>

<style>
  .accordion {
    display: grid;
    grid-template-rows: 52px 0fr;
    transition: grid-template-rows 300ms;
  }
  .accordion.open {
    grid-template-rows: 52px 1fr;
  }
  .accordion__content {
    overflow: hidden;
  }
</style>

<script>
  import type { CustomEventWithDetail } from '../types';

  const page = document.getElementById('page-content') as HTMLElement | null;
  const menu = document.getElementById('mobile-menu') as HTMLElement | null;
  const accordionBtn = menu?.querySelector('.accordion button') as HTMLButtonElement | null;

  function toggleAccordion() {
    menu?.querySelector('.accordion')?.classList.toggle('open');
    menu?.querySelector('.accordion .icon')?.classList.toggle('rotate-180');
  }

  function openMenu() {
    menu?.classList.remove('opacity-0', 'pointer-events-none');
    page?.classList.add('pointer-events-none');
    if (menu && menu.dataset) menu.dataset.state = 'open';
  }

  function closeMenu() {
    menu?.classList.add('opacity-0', 'pointer-events-none');
    page?.classList.remove('pointer-events-none');
    if (menu && menu.dataset) menu.dataset.state = 'close';
  }

  function mobileMenuToggle(ev: CustomEventWithDetail<{ command: string }>) {
    if (ev.detail.command === 'open') openMenu();
    if (ev.detail.command === 'close') closeMenu();
  }

  accordionBtn?.addEventListener('click', toggleAccordion);
  window.addEventListener('mobileMenuToggle', mobileMenuToggle as EventListener);
</script>
